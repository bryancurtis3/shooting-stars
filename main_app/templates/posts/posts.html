{% extends 'base.html' %}
{% load static %}
{% load sass_tags %}

{% block styles %}
<link rel="stylesheet" href="{% sass_src 'styles/posts/posts.scss'%}">
{% endblock styles %}

{% block scripts %}
<script src="{% static 'scripts/posts.js'%}"></script>
{% endblock scripts %}


{% block content %}

<section class="header">

    <h1>All Posts</h1>

    <i class="far fa-plus-square" onClick="modal()" title="New Post"></i>

    <form class="search" action="/posts" method="GET">
        <input 
        name="q"
        {% comment %} class="search" {% endcomment %}
        type="search" 
        placeholder="Search by coordinates"
        >
    </form>

</section>



<section class="posts">
{% for post in posts  %}

<article class="post">
    <a class="title" href="/posts/{{post.pk}}">{{post.title}}</a>
    <div class="subtitle">
        <h4>{{post.user.username}}</h4>
        <p class="coords">{{post.lat}}, {{post.long}}</p>
    </div>
    <a href="{{post.image}}" target="_blank" title="See full sized image">
        {% comment %} <img src="{{post.image}}" alt="Post image"> {% endcomment %}
    </a>
    <p class="description">
        {{post.description|truncatechars:"150"}}
        {% if post.description|length > 150 %}
            <span id="more" onClick="more()">more</span>
        {% endif %}
    </p>
    <p class="description-full">
        {{post.description}}
        <span onClick="more()">less</span>
    </p>
    
</article>


{% endfor %}
</section>

<form class="modal" action="{% url 'post_create' %}" method="POST">
    {% csrf_token %}
    {{form.as_p}}
    <input type="submit" value="Submit"></input>
</form>



{% if messages %}
    {% for message in messages %}
        <section class="message">
            <p>{{message}}</p>
            <i class="fas fa-times" onClick="message()"></i>
        </section>
    {% endfor %}
{% endif %}

{% endblock content %}